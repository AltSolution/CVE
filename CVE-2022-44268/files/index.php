<!DOCTYPE html>
<html>
<head>
    <title>Upload and Resize Image</title>
</head>
<body>
    <h1>Upload and Resize Image</h1>

    <?php
    // Check if a file was uploaded
    if (isset($_FILES['image'])) {
        // Get the file details
        $file = $_FILES['image']['tmp_name'];
        $filename = $_FILES['image']['name'];
        $filetype = $_FILES['image']['type'];

        // Check if the file is a PNG image
        if ($filetype === 'image/png') {
            // Generate a unique name for the file (maximum 8 characters)
            $newFilename = substr(md5(uniqid()), 0, 8);

            // Set the dimensions for the resized image
            $newWidth = 50;

            // Use ImageMagick to resize the image
            $imagick = new Imagick($file);
            $imagick->scaleImage($newWidth, 0);

            // Save the resized image with the generated name and the original file extension
            $imagick->writeImage('upload/' . $newFilename . '.png');
            $imagick->clear();
            $imagick->destroy();

            echo '<p>Resized Image:</p>';
            echo '<img src="upload/' . $newFilename . '.png" alt="Resized Image">';

            // Delete the original file
            unlink($file);
        } else {
            echo '<p>Only PNG images are allowed.</p>';
        }
    }
    ?>

    <form action="" method="post" enctype="multipart/form-data">
        <input type="file" name="image" accept=".png">
        <input type="submit" value="Upload and Resize">
    </form>
</body>
</html>

